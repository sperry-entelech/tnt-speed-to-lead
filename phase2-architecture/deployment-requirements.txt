# TNT Corporate Lead System - Deployment Requirements
# Phase 2 Architecture - Hosting, Security, and Performance Specifications
# Generated using architect-mcp.json specifications

# =====================================================
# HOSTING INFRASTRUCTURE REQUIREMENTS
# =====================================================

## Primary Hosting Options (Recommended: Option A)

### Option A: Cloud-Native Deployment (Recommended)
# Frontend: Vercel (Next.js optimized)
# Backend: Railway (Node.js + PostgreSQL)
# Redis: Railway Redis Add-on
# CDN: Cloudflare (free tier)
# DNS: Cloudflare DNS
# Monitoring: Sentry + Built-in platform monitoring

### Option B: Azure Enterprise Deployment
# Frontend: Azure Static Web Apps
# Backend: Azure App Service (Node.js)
# Database: Azure Database for PostgreSQL Flexible Server
# Cache: Azure Cache for Redis
# CDN: Azure Front Door
# DNS: Azure DNS

### Option C: Self-Hosted VPS Deployment
# VPS: Digital Ocean Droplet (4GB RAM minimum)
# Containerization: Docker + Docker Compose
# Reverse Proxy: Nginx
# SSL: Let's Encrypt with Certbot
# Backup: Automated off-site backups

# =====================================================
# MINIMUM SYSTEM REQUIREMENTS
# =====================================================

## Frontend Hosting
CPU: 1 vCPU (auto-scaling enabled)
RAM: 512MB base allocation
Storage: 5GB SSD (build artifacts and static assets)
Bandwidth: 100GB/month (estimated 1,000 page views/month)
CDN: Global edge caching for <200ms response times worldwide

## Backend API Server
CPU: 2 vCPU cores minimum (4 vCPU recommended for peak load)
RAM: 2GB minimum (4GB recommended)
Storage: 20GB SSD for application files
Network: 1TB/month bandwidth
Uptime SLA: 99.9% minimum

## Database Server
PostgreSQL Version: 15+
CPU: 2 vCPU cores
RAM: 4GB (with 2GB shared_buffers configuration)
Storage: 50GB SSD with automatic scaling to 200GB
IOPS: 3,000 baseline (burstable to 16,000)
Connections: 100 concurrent connections maximum
Backup: Automated daily backups with 30-day retention

## Redis Cache/Queue
RAM: 1GB allocation
CPU: Shared vCPU (sufficient for queue processing)
Persistence: RDB snapshots + AOF logging
Eviction Policy: allkeys-lru for cache data
Network: Private network connection to API server

# =====================================================
# PERFORMANCE REQUIREMENTS
# =====================================================

## Response Time Targets
API Endpoints: <500ms average response time
Database Queries: <100ms for indexed queries (95th percentile)
Email Delivery: <5 minutes guaranteed (business requirement)
Dashboard Load Time: <3 seconds (Time to Interactive)
Lead Processing: End-to-end <5 minutes (capture to response)

## Scalability Specifications
Concurrent Users: 100+ during peak season (wedding/event season)
Lead Volume: 1,000+ leads per month (peak: 5 leads/hour)
Email Volume: 5,000+ emails per month
Database Growth: 10GB per year projected
Peak Traffic: 5x baseline during wedding season (March-October)

## Load Testing Targets
API Load: 100 requests/second sustained
Database Load: 500 queries/second peak
Email Queue: 50 emails/minute processing rate
Memory Usage: <80% during normal operations
CPU Usage: <70% during normal operations

# =====================================================
# SECURITY REQUIREMENTS
# =====================================================

## SSL/TLS Configuration
Certificate Type: Wildcard SSL certificate (*.tntlimousine.com)
TLS Version: TLS 1.3 minimum (TLS 1.2 acceptable)
Cipher Suites: Modern cipher suites only (AEAD preferred)
HSTS: Enabled with 1-year max-age
Certificate Authority: Let's Encrypt or commercial CA

## Data Encryption
At Rest: AES-256 encryption for database and file storage
In Transit: TLS 1.3 for all API communications
Key Management: Environment variable encryption keys
Database: Transparent Data Encryption (TDE) enabled
Backup Encryption: AES-256 for all backup data

## Access Control
Authentication: JWT tokens with 15-minute expiry
Refresh Tokens: 7-day expiry with rotation
Password Policy: 12+ characters, mixed case, numbers, symbols
Account Lockout: 5 failed attempts = 15-minute lockout
Session Management: Secure session handling with CSRF protection

## Network Security
Firewall: Allow only HTTP(S) traffic on ports 80/443
Database Access: Private network access only (no public IP)
API Rate Limiting: 1000 requests/hour per IP
DDoS Protection: Cloudflare DDoS protection enabled
IP Whitelisting: Admin access restricted to TNT office IPs

## Data Privacy Compliance
GDPR: Right to deletion, data portability, consent management
CCPA: California Consumer Privacy Act compliance
Data Retention: Configurable retention policies (default 7 years)
Audit Logging: Complete audit trail for all data access
Privacy Policy: Updated privacy policy with data processing details

# =====================================================
# BACKUP & DISASTER RECOVERY
# =====================================================

## Backup Strategy
Database Backups:
- Real-time: Continuous WAL archiving
- Daily: Full database backup at 2:00 AM EST
- Weekly: Full system backup including application files
- Monthly: Archive backup for long-term retention
- Retention: 30 days daily, 12 weeks weekly, 7 years monthly

Application Backups:
- Code Repository: Git version control (GitHub)
- Configuration: Infrastructure as Code (Terraform)
- Environment Variables: Encrypted backup in secure vault
- SSL Certificates: Automated renewal with backup storage

## Disaster Recovery
RTO (Recovery Time Objective): <4 hours for full system restore
RPO (Recovery Point Objective): <1 hour maximum data loss
Backup Testing: Monthly restore testing to verify backup integrity
Failover Plan: Documented step-by-step recovery procedures
Geographic Distribution: Backups stored in multiple regions

## Monitoring & Alerting
Uptime Monitoring: External monitoring every 1 minute
Performance Monitoring: Application performance tracking
Error Tracking: Real-time error alerts and stack traces
Database Monitoring: Query performance and connection health
Integration Monitoring: Third-party API health checks

Alert Channels:
- Critical: SMS to TNT managers + email
- Warning: Email to system administrators
- Info: Dashboard notifications only

# =====================================================
# ENVIRONMENT CONFIGURATION
# =====================================================

## Environment Variables (Required)

### Database Configuration
DATABASE_URL=postgresql://username:password@host:port/database_name
REDIS_URL=redis://host:port/database_number
DATABASE_POOL_SIZE=20
DATABASE_TIMEOUT=30000

### Application Configuration
NODE_ENV=production
PORT=3000
API_VERSION=v2
CORS_ORIGIN=https://dashboard.tntlimousine.com
SESSION_SECRET=<256-bit-random-string>
JWT_SECRET=<256-bit-random-string>
ENCRYPTION_KEY=<fernet-compatible-key>

### Integration API Keys (Encrypted)
ZOHO_CLIENT_ID=<zoho-oauth-client-id>
ZOHO_CLIENT_SECRET=<encrypted-client-secret>
ZOHO_REFRESH_TOKEN=<encrypted-refresh-token>
FASTTRACK_API_ENDPOINT=<fasttrack-api-url>
FASTTRACK_API_KEY=<encrypted-api-key>
RICHWEB_SMTP_USERNAME=<smtp-username>
RICHWEB_SMTP_PASSWORD=<encrypted-smtp-password>

### Notification Configuration
SLACK_WEBHOOK_URL=<slack-webhook-url>
TWILIO_ACCOUNT_SID=<twilio-account-sid>
TWILIO_AUTH_TOKEN=<encrypted-twilio-token>
TWILIO_FROM_NUMBER=<tnt-twilio-phone-number>
TNT_MANAGER_PHONE_1=<manager-phone-1>
TNT_MANAGER_PHONE_2=<manager-phone-2>

### Application URLs
TNT_API_URL=https://api.tntlimousine.com
TNT_DASHBOARD_URL=https://dashboard.tntlimousine.com
TNT_WEBHOOK_URL=https://api.tntlimousine.com/webhooks

### Monitoring & Logging
SENTRY_DSN=<sentry-error-tracking-dsn>
LOG_LEVEL=info
ANALYTICS_ENABLED=true

## Environment-Specific Configurations

### Development Environment
DEBUG=true
LOG_LEVEL=debug
EMAIL_TESTING_MODE=true
INTEGRATION_TESTING_MODE=true
RATE_LIMITING_ENABLED=false

### Staging Environment
DEBUG=false
LOG_LEVEL=info
EMAIL_TESTING_MODE=true
INTEGRATION_TESTING_MODE=false
RATE_LIMITING_ENABLED=true
DATABASE_POOL_SIZE=10

### Production Environment
DEBUG=false
LOG_LEVEL=warn
EMAIL_TESTING_MODE=false
INTEGRATION_TESTING_MODE=false
RATE_LIMITING_ENABLED=true
DATABASE_POOL_SIZE=20
PERFORMANCE_MONITORING=true

# =====================================================
# DEPLOYMENT AUTOMATION
# =====================================================

## CI/CD Pipeline Requirements

### GitHub Actions Workflow
- Automated testing on pull requests
- Security scanning with CodeQL
- Dependency vulnerability checking
- Automated deployment to staging on merge to main
- Manual approval required for production deployment
- Rollback capability for failed deployments

### Build Process
1. Install dependencies (npm ci)
2. Run linting and type checking
3. Execute unit tests (Jest)
4. Execute integration tests
5. Build production assets
6. Create Docker containers
7. Push to container registry
8. Deploy to target environment
9. Run smoke tests
10. Health check verification

## Infrastructure as Code

### Terraform Configuration
- Database provisioning with proper sizing
- Network security group configuration
- Load balancer setup
- SSL certificate management
- Monitoring and alerting setup
- Backup configuration

### Docker Configuration
```dockerfile
# Multi-stage build for optimized production image
FROM node:18-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS production
WORKDIR /app
COPY --from=build /app/node_modules ./node_modules
COPY . .
EXPOSE 3000
USER node
CMD ["npm", "start"]
```

# =====================================================
# COST ESTIMATES (Monthly)
# =====================================================

## Option A: Cloud-Native (Recommended)
Vercel Pro Plan: $20/month (frontend hosting)
Railway Pro Plan: $20/month (backend + database + redis)
Cloudflare Pro: $20/month (CDN + security)
Sentry Developer: $26/month (error tracking)
Domain & SSL: $15/month (domain + wildcard SSL)
SMS Credits: $10/month (estimated 200 SMS/month)
Total: ~$111/month

## Option B: Azure Enterprise
App Service: $75/month (B2 tier)
PostgreSQL Flexible: $85/month (2 vCPU, 4GB RAM)
Redis Cache: $30/month (C1 tier)
Front Door: $25/month
Static Web Apps: $9/month
Total: ~$224/month

## Option C: Self-Hosted VPS
Digital Ocean Droplet: $48/month (4GB RAM, 2 vCPU)
Block Storage: $10/month (100GB SSD)
Load Balancer: $12/month
Backup: $5/month
Domain & SSL: $15/month
Total: ~$90/month

# =====================================================
# DEPLOYMENT CHECKLIST
# =====================================================

## Pre-Deployment Requirements
□ Environment variables configured and encrypted
□ Database schema deployed and tested
□ SSL certificates installed and verified
□ DNS records configured (A, CNAME, MX)
□ Third-party API credentials validated
□ Email templates created and tested
□ Backup strategy implemented and tested
□ Monitoring and alerting configured
□ Security scanning completed
□ Performance testing completed

## Go-Live Checklist
□ Production database backup created
□ All integrations tested in production environment
□ Email delivery tested with real SMTP provider
□ Lead capture form tested end-to-end
□ Manager notification system tested
□ Dashboard access verified for all user roles
□ Performance monitoring active
□ Error tracking active
□ Backup automation verified
□ DNS propagation completed

## Post-Deployment Monitoring
□ System health dashboard monitoring
□ Error rate monitoring (target: <0.1%)
□ Response time monitoring (target: <500ms API)
□ Email delivery rate monitoring (target: >98%)
□ Lead conversion tracking active
□ Integration sync status monitoring
□ Database performance monitoring
□ Security event monitoring

# =====================================================
# SUPPORT & MAINTENANCE
# =====================================================

## Ongoing Maintenance Requirements
- Weekly security updates and patches
- Monthly backup verification and testing
- Quarterly performance optimization review
- Annual security audit and penetration testing
- Continuous monitoring and alerting
- 24/7 system availability monitoring

## Support Contact Information
Technical Support: admin@tntlimousine.com
Emergency Contact: <TNT-manager-phone>
System Status Page: https://status.tntlimousine.com
Documentation: https://docs.tntlimousine.com/system

## SLA Commitments
System Uptime: 99.9% (8.76 hours downtime/year maximum)
Response Time: <5 minutes for lead capture and automated response
Email Delivery: <5 minutes guaranteed delivery time
Support Response: <4 hours for critical issues, <24 hours for standard

---

## Implementation Notes

This deployment requirements document provides the technical foundation for:

**Phase 4**: TNT environment deployment with live URLs (2 days)
- Infrastructure provisioning and configuration
- Application deployment and testing
- DNS configuration and SSL setup
- Integration testing and validation

The specifications ensure the system can handle TNT's business requirements:
- 24/7 automated lead capture and response
- <5-minute response time guarantee
- Support for 3-5 additional corporate bookings monthly
- $15K+ monthly revenue recovery through improved conversion